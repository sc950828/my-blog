### 1、浏览器的渲染进程是多线程

    1.GUI渲染线程
      负责渲染浏览器界面,解析 HTML,CSS,构建 DOM 树和 RenderObject 树,布局和绘制等。 GUI 渲染线程与 JS 引擎线程是互斥的
    2.JS引擎线程
      JS 引擎线程负责解析 Javascript 脚本,运行代码。 GUI 渲染线程与 JS 引擎线程是互斥的
    3.事件触发线程
      当对应的事件符合触发条件被触发时,该线程会把事件添加到待处理队列的队尾,等待 JS 引擎的处理
    4.定时触发器线程
      setInterval 与 setTimeout 所在线程， 定时器所在的线程
    5.异步http请求线程
      请求的线程

### 2、渲染流程

- 解析 HTML 文件，构建 DOM 树。下载解析 css 生成 css 树。这两个是并行的。
- css 树构建完成与 html dom 树组合形成 RenderObject 树。
- 根据 render 树布局（Layout/reflow），负责各元素尺寸、位置的计算。(涉及到回流)
- 根据 render 树绘制（paint），绘制页面像素信息。(涉及到重绘)
- 浏览器会将各层的信息发送给 GPU，GPU 将各层合成（composite），显示在屏幕上。

### 3、为什么 js 是单线程的？

这是因为 Javascript 这门脚本语言诞生的使命所致!
假设 js 是多线程，如果多个 js 线程操作同一个 dom 元素，一个删除 一个修改这样就会造成冲突
当然我们可以通过锁来解决上面的问题。但为了避免因为引入了锁而带来更大的复杂性,Javascript 在最初就选择了单线程执行。

### 4、为什么 js 阻塞页面的加载？

由于 JavaScript 是可操纵 DOM 的,如果在修改这些元素属性同时渲染界面（即 JavaScript 线程和 GUI 线程同时运行）,那么就会引发冲突。
因此为了防止渲染出现不可预期的结果,浏览器设置 GUI 渲染线程与 JavaScript 引擎为互斥的关系

### 5、css 会阻塞页面的加载吗？

因为 css 解析和 html 解析是同步的 所以 css 加载不会阻塞 dom 的解析。
由于页面的加载是基于 html 树和 css 树组合的 render 树，所以 css 会阻塞页面的渲染。
所以如果 js 在 css 后面，css 会阻塞后面 js 的执行。

### 6、渲染页面时常见哪些不良现象？

- FOUC：主要指的是样式闪烁的问题，由于浏览器渲染机制（比如 firefox），在 CSS 加载之前，先呈现了 HTML，就会导致展示出无样式内容，然后样式突然呈现的现象。会出现这个问题的原因主要是 css 加载时间过长，或者 css 被放在了文档底部。

- 白屏：有些浏览器渲染机制（比如 chrome）要先构建 DOM 树和 CSSOM 树，构建完成后再进行渲染，如果 CSS 部分放在 HTML 尾部，由于 CSS 未加载完成，浏览器迟迟未渲染，从而导致白屏；也可能是把 js 文件放在头部，脚本的加载会阻塞后面文档内容的解析，从而页面迟迟未渲染出来，出现白屏问题。

### 7、什么是文档的预解析？

Webkit 和 Firefox 都做了这个优化，当执行 JavaScript 脚本时，另一个线程解析剩下的文档，并加载后面需要通过网络加
载的资源。这种方式可以使资源并行加载从而使整体速度更快。需要注意的是，预解析并不改变 DOM 树，它将这个工作留给主解析
过程，自己只解析外部资源的引用，比如外部脚本、样式表及图片。

### 8、如何优化关键渲染路径？

- 为尽快完成首次渲染，我们需要最大限度减小以下三种可变因素：

  - （1）关键资源的数量。
  - （2）关键路径长度。
  - （3）关键字节的数量。

- 关键资源数量是可能阻止网页首次渲染的资源。这些资源越少，浏览器的工作量就越小，对 CPU 以及其他资源的占用也就越少。
  同样，关键路径长度受所有关键资源与其字节大小之间依赖关系图的影响：某些资源只能在上一资源处理完毕之后才能开始下载，
  并且资源越大，下载所需的往返次数就越多。最后，浏览器需要下载的关键字节越少，处理内容并让其出现在屏幕上的速度就越快。要减少字节数，我们可以减少资源数（将它们删除或设为非关键资源），此外还要压缩和优化各项资源，确保最大限度减小传送大小。

- 优化关键渲染路径的常规步骤如下：
  - （1）对关键路径进行分析和特性描述：资源数、字节数、长度。
  - （2）最大限度减少关键资源的数量：删除它们，延迟它们的下载，将它们标记为异步等。
  - （3）优化关键字节数以缩短下载时间（往返次数）。
  - （4）优化其余关键资源的加载顺序：您需要尽早下载所有关键资产，以缩短关键路径长度。
