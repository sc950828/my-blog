## HTTPS

https 是安全的 http 协议

## 加密方式有哪些？

- 对称加密 加密解密使用同一把密钥 传输密钥不太安全
- 非对称加密 公钥是公开的使用公钥加密 私钥只有自己知道使用私钥解密(SSL)

## 什么是 TLS、SSL

通俗的讲，TLS、SSL 其实是类似的东西，SSL 是个加密套件，负责对 HTTP 的数据进行加密。TLS 是 SSL 的升级版。现在提到 HTTPS，加密套件基本指的是 TLS。

## 什么是数字证书？

数字证书是可信任阻止颁发给特定对象的认证

非对称加密中，双方使用公钥进行解密。虽然数字签名可以保证数据不被替换，但是数据是由公钥加密的，如果公钥也被替换，则仍然可以伪造数据，因为用户不知道对方提供的公钥其实是假的。所以为了保证发送方的公钥是真的，CA 证书机构会负责颁发一个证书，里面的公钥保证是真的，用户请求服务器时，服务器将证书发给用户，这个证书是经由系统内置证书的备案的。

## 怎么验证证书的有效性

1. 服务器把证书发送过来，证书上有一些基本信息和一个签名，签名的内容是指纹算法和指纹，指纹内容是基本信息通过指纹算法计算出来的 hash 值。签名是证书机构通过私钥加密的。
2. 客户端寻找内置证书，判断服务器发来的证书是否在自己内置的证书列表，找到了就使用内置证书的公钥解密签名得到指纹和指纹算法，然后使用指纹算法计算内容的 hash，拿这两个 hash 对比判断是否一致，一致就通过。

## SSL 握手

1. 客户端向服务器发起请求，请求中包含使用的协议版本号、生成的一个随机数 1、以及客户端支持的加密方法。
2. 服务器端接收到请求后，确认双方使用的加密方法、并给出服务器的证书、以及一个服务器生成的随机数 2。
3. 客户端确认服务器证书有效后，生成一个新的随机数 3，并使用数字证书中的公钥，加密这个随机数 3，然后发给服务器。并且还会提供一个前面所有内容的 hash 的值，用来供服务器检验。
4. 服务器使用自己的私钥，来解密客户端发送过来的随机数 3。并提供前面所有内容的 hash 值来供客户端检验。
5. 客户端和服务器端根据约定的加密方法使用前面的三个随机数，生成对话秘钥，以后的对话过程都使用这个秘钥来对称加密信息。

## https 保证安全传输的原因

1. TCP 的三次握手，在 443 端口建立连接
2. SSL 握手（比 http 多的这一步）
3. 数据传输

总结

- https 是使用了非对称加密和对称加密相结合的方式。
- https 并不是直接通过非对称加密传输过程，而是有握手过程，握手过程主要是和服务器做通讯，通过非对称加密的方式生成对称的私有秘钥，最后通过该秘钥对称加密传输数据。
- 使用了证书，证书验证过程保证了对方是合法的，并且中间人无法通过伪造证书方式进行攻击。

## http 和 https 异同？

1. http

- http 使用明文 内容可能会被窃听
- http 不验证通信方的身份 可能会被伪装
- http 无法证明报文的完整性 可能会被篡改
- http 端口是 80
- http 与 tcp 进行通信，而 https 与 ssl 或者 tls 层通信

2. https

- https 端口是 443
- https 多了证书这一概念
- https 不是新的协议 是身披 ssl/tls 协议外壳的 http
- HTTP 协议运行在 TCP 之上，所有传输的内容都是明文，HTTPS 运行在 SSL/TLS 之上，SSL/TLS 运行在 TCP 之上，所有传输的内容都经过加密的。
- https 采用公开密钥加密和共享密钥加密两者并用的加密方式
