### 背景

在近些年来，随着互联网越来越开发和协作，目前的系统登录方式也越来越多，已经远远超越了以前的单用户名的方式了。除了用户名密码外，一般网站还提供如下的登录方式 微信/QQ/新浪微博（国内）Google/Facebook/Github（国外）

### 准备工作

在进行微信 OAuth2.0 授权登录接入之前，在微信开放平台注册开发者帐号，并拥有一个已审核通过的网站应用，并获得相应的 AppID 和 AppSecret，申请微信登录且通过审核后，可开始接入流程。

### 扫码登录简要步骤

![image](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/66d463b6ee1f4f72b7367eb7ab2aa1d8~tplv-k3u1fbpfcp-zoom-1.image)

### 扫码登录详细分析

默认该第三方平台网站应用已完成审核

1. 在第三方网站当我们点击使用微信登录的时候，会请求第三方服务器，第三方服务器会随机生成一个 id(名字不定)，携带 id 然后重定向到微信授权页面，微信服务器会生成一个 uuid，并生成的二维码（里面包含 uuid），展示到页面。

2. 授权页面会带上 uuid 一直轮询微信服务器，看用户是否扫码。

3. 当我们拿微信扫描二维码，解析二维码弹出授权框，用户同意授权后，携带二维码里面的 uuid 请求微信服务器。微信服务器验证成功后会生成 code，携带 code 重定向到第三方服务器指定链接。

4. 第三方服务器通过 code AppID 和 AppSecret 请求微信服务器获取 access_token

5. 第三方服务器通过 access_token 请求微信服务器获取扫码人的用户信息（openid，unionid，nickname...）

6. 第三方服务器判断该微信用户是否注册过，通过唯一字段（unionid 或者 openid 查询数据库是否有该用户）

- 没查到就是没注册过：第三方服务器创建一个新用户，并与扫码人的用户信息绑定。返回该用户信息，并返回登录成功。
- 查到了就是注册过：第三方服务器返回该用户信息，并返回登录成功。

### 总结

这里只是初步的一个探索，如果后续正式接入的时候可能还有很多细节问题需要考虑。
